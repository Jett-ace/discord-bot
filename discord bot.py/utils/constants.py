# Fate Series Servant Pool
characters = [
    # SSR Servants - Legendary Heroes
    {
        "name": "Artoria Pendragon",
        "rarity": "SSR",
        "class": "Saber",
        "hp": 1350,
        "atk": 320,
        "noble_phantasm": "Excalibur",
        "passive": "charisma",
        "description": "King of Knights",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Artoria+Pendragon"
    },
    {
        "name": "Gilgamesh",
        "rarity": "SSR",
        "class": "Archer",
        "hp": 1200,
        "atk": 350,
        "noble_phantasm": "Gate of Babylon",
        "passive": "golden_rule",
        "description": "King of Heroes",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Gilgamesh"
    },
    {
        "name": "Cu Chulainn (Alter)",
        "rarity": "SSR",
        "class": "Berserker",
        "hp": 1400,
        "atk": 330,
        "noble_phantasm": "Curruid Coinchenn",
        "passive": "madness_enhancement",
        "description": "Mad Beast of Ireland",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Cu+Chulainn+Alter"
    },
    {
        "name": "Scathach",
        "rarity": "SSR",
        "class": "Lancer",
        "hp": 1250,
        "atk": 325,
        "noble_phantasm": "Gae Bolg Alternative",
        "passive": "wisdom_of_dun_scaith",
        "description": "Queen of the Land of Shadows",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Scathach"
    },
    {
        "name": "Ishtar",
        "rarity": "SSR",
        "class": "Archer",
        "hp": 1180,
        "atk": 340,
        "noble_phantasm": "An Gal Ta Kigal She",
        "passive": "manifestation_of_beauty",
        "description": "Goddess of Beauty and War",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Ishtar"
    },
    {
        "name": "Jeanne d'Arc",
        "rarity": "SSR",
        "class": "Ruler",
        "hp": 1600,
        "atk": 260,
        "noble_phantasm": "La Pucelle",
        "passive": "true_name_revelation",
        "description": "The Maid of Orleans",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Jeanne+d'Arc"
    },
    {
        "name": "Ozymandias",
        "rarity": "SSR",
        "class": "Rider",
        "hp": 1280,
        "atk": 310,
        "noble_phantasm": "Ramesseum Tentyris",
        "passive": "imperial_privilege",
        "description": "King of Kings",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Ozymandias"
    },
    {
        "name": "Merlin",
        "rarity": "SSR",
        "class": "Caster",
        "hp": 1100,
        "atk": 280,
        "noble_phantasm": "Garden of Avalon",
        "passive": "dreamlike_charisma",
        "description": "Magus of Flowers",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Merlin"
    },
    {
        "name": "Karna",
        "rarity": "SSR",
        "class": "Lancer",
        "hp": 1220,
        "atk": 335,
        "noble_phantasm": "Vasavi Shakti",
        "passive": "uncrowned_arms_mastership",
        "description": "Son of the Sun God",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Karna"
    },
    {
        "name": "Mysterious Heroine X",
        "rarity": "SSR",
        "class": "Assassin",
        "hp": 1150,
        "atk": 315,
        "noble_phantasm": "Secret-Calibur",
        "passive": "cosmo_reactor",
        "description": "Saber Hunter",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Mysterious+Heroine+X"
    },
    {
        "name": "Mordred",
        "rarity": "SSR",
        "class": "Saber",
        "hp": 1300,
        "atk": 330,
        "noble_phantasm": "Clarent Blood Arthur",
        "passive": "instinct",
        "description": "Treacherous Knight",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Mordred"
    },
    {
        "name": "Jack the Ripper",
        "rarity": "SSR",
        "class": "Assassin",
        "hp": 1050,
        "atk": 360,
        "noble_phantasm": "Maria the Ripper",
        "passive": "murderer_of_the_misty_night",
        "description": "London's Most Infamous Killer",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Jack+the+Ripper"
    },
    {
        "name": "Heracles",
        "rarity": "SSR",
        "class": "Berserker",
        "hp": 1550,
        "atk": 345,
        "noble_phantasm": "Nine Lives",
        "passive": "battle_continuation",
        "description": "Greece's Greatest Hero",
        "image": "https://via.placeholder.com/512x724/FFD700/FFFFFF?text=Heracles"
    },
    
    # SR Servants - Elite Heroes
    {
        "name": "Emiya",
        "rarity": "SR",
        "class": "Archer",
        "hp": 980,
        "atk": 230,
        "noble_phantasm": "Unlimited Blade Works",
        "passive": "projection",
        "description": "Nameless Hero",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Emiya"
    },
    {
        "name": "Medusa",
        "rarity": "SR",
        "class": "Rider",
        "hp": 920,
        "atk": 225,
        "noble_phantasm": "Bellerophon",
        "passive": "mystic_eyes",
        "description": "Gorgon Sister",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Medusa"
    },
    {
        "name": "Lancelot",
        "rarity": "SR",
        "class": "Berserker",
        "hp": 1020,
        "atk": 240,
        "noble_phantasm": "Knight of Owner",
        "passive": "eternal_arms_mastership",
        "description": "Knight of the Lake",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Lancelot"
    },
    {
        "name": "Tamamo-no-Mae",
        "rarity": "SR",
        "class": "Caster",
        "hp": 890,
        "atk": 210,
        "noble_phantasm": "Eightfold Blessing",
        "passive": "fox_wedding",
        "description": "Nine-Tailed Fox Spirit",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Tamamo-no-Mae"
    },
    {
        "name": "Atalante",
        "rarity": "SR",
        "class": "Archer",
        "hp": 880,
        "atk": 235,
        "noble_phantasm": "Phoebus Catastrophe",
        "passive": "calydonian_hunt",
        "description": "Swift Huntress",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Atalante"
    },
    {
        "name": "Siegfried",
        "rarity": "SR",
        "class": "Saber",
        "hp": 1050,
        "atk": 220,
        "noble_phantasm": "Balmung",
        "passive": "armor_of_fafnir",
        "description": "Dragon Slayer",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Siegfried"
    },
    {
        "name": "Medea",
        "rarity": "SR",
        "class": "Caster",
        "hp": 850,
        "atk": 205,
        "noble_phantasm": "Rule Breaker",
        "passive": "high_speed_divine_words",
        "description": "Witch of Betrayal",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Medea"
    },
    {
        "name": "Diarmuid",
        "rarity": "SR",
        "class": "Lancer",
        "hp": 910,
        "atk": 228,
        "noble_phantasm": "Gae Dearg",
        "passive": "love_spot",
        "description": "First Knight of Fianna",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Diarmuid"
    },
    {
        "name": "Carmilla",
        "rarity": "SR",
        "class": "Assassin",
        "hp": 870,
        "atk": 240,
        "noble_phantasm": "Phantom Maiden",
        "passive": "vampire",
        "description": "Vampire Countess",
        "image": "https://via.placeholder.com/512x724/9B59B6/FFFFFF?text=Carmilla"
    },
    
    # R Servants - Reliable Warriors
    {
        "name": "Cu Chulainn",
        "rarity": "R",
        "class": "Lancer",
        "hp": 780,
        "atk": 140,
        "noble_phantasm": "Gae Bolg",
        "passive": "protection_from_arrows",
        "description": "Child of Light",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Cu+Chulainn"
    },
    {
        "name": "Medea (Lily)",
        "rarity": "R",
        "class": "Caster",
        "hp": 720,
        "atk": 125,
        "noble_phantasm": "Pain Breaker",
        "passive": "rapid_casting",
        "description": "Innocent Princess",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Medea+Lily"
    },
    {
        "name": "Robin Hood",
        "rarity": "R",
        "class": "Archer",
        "hp": 750,
        "atk": 135,
        "noble_phantasm": "Yew Bow",
        "passive": "sabotage",
        "description": "Outlaw of Sherwood",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Robin+Hood"
    },
    {
        "name": "Hassan of the Cursed Arm",
        "rarity": "R",
        "class": "Assassin",
        "hp": 700,
        "atk": 145,
        "noble_phantasm": "Zabaniya",
        "passive": "presence_concealment",
        "description": "Assassin Leader",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Hassan"
    },
    {
        "name": "Boudica",
        "rarity": "R",
        "class": "Rider",
        "hp": 800,
        "atk": 120,
        "noble_phantasm": "Sword of Boudica",
        "passive": "battle_continuation",
        "description": "Warrior Queen",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Boudica"
    },
    {
        "name": "Sasaki Kojiro",
        "rarity": "R",
        "class": "Assassin",
        "hp": 680,
        "atk": 150,
        "noble_phantasm": "Tsubame Gaeshi",
        "passive": "eye_of_the_mind",
        "description": "Nameless Swordsman",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Sasaki+Kojiro"
    },
    {
        "name": "Spartacus",
        "rarity": "R",
        "class": "Berserker",
        "hp": 850,
        "atk": 130,
        "noble_phantasm": "Crying Warmonger",
        "passive": "honor_of_the_battered",
        "description": "Rebellious Gladiator",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Spartacus"
    },
    {
        "name": "Arash",
        "rarity": "R",
        "class": "Archer",
        "hp": 660,
        "atk": 155,
        "noble_phantasm": "Stella",
        "passive": "robust_health",
        "description": "Hero of Persia",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Arash"
    },
    {
        "name": "Gilles de Rais",
        "rarity": "R",
        "class": "Caster",
        "hp": 710,
        "atk": 128,
        "noble_phantasm": "Prelati's Spellbook",
        "passive": "mental_pollution",
        "description": "Mad Marshal",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Gilles+de+Rais"
    },
    {
        "name": "Darius III",
        "rarity": "R",
        "class": "Berserker",
        "hp": 820,
        "atk": 135,
        "noble_phantasm": "Athanaton Ten Thousand",
        "passive": "golden_rule",
        "description": "Fallen Persian King",
        "image": "https://via.placeholder.com/512x724/2ECC71/FFFFFF?text=Darius+III"
    },
]

rarity_weights = {"SSR": 0.01, "SR": 0.14, "R": 0.85}

# Custom Discord Emojis for Rarity
rarity_emojis = {
    "SSR": "<:SSR:1444709117058089064>",
    "SR": "<:SR:1444709138582995109>",
    "R": "<:Rare:1444709489285660834>"
}

# Fate Servant Classes with advantages and level requirements
servant_classes = {
    "saber": {"name": "Saber", "level": 0, "advantage": "Lancer", "description": "Knights of the sword"},
    "archer": {"name": "Archer", "level": 5, "advantage": "Saber", "description": "Masters of ranged combat"},
    "lancer": {"name": "Lancer", "level": 10, "advantage": "Archer", "description": "Spear-wielding warriors"},
    "rider": {"name": "Rider", "level": 15, "advantage": "Caster", "description": "Mount commanders"},
    "caster": {"name": "Caster", "level": 20, "advantage": "Assassin", "description": "Mages and sorcerers"},
    "assassin": {"name": "Assassin", "level": 25, "advantage": "Rider", "description": "Silent killers"},
    "berserker": {"name": "Berserker", "level": 30, "advantage": "All", "description": "Mad warriors with boosted power"},
    "ruler": {"name": "Ruler", "level": 35, "advantage": "None", "description": "Neutral arbiters"},
}

class_lookup = {
    # Saber Class
    "Artoria Pendragon": "Saber", "Mordred": "Saber", "Siegfried": "Saber",
    
    # Archer Class
    "Gilgamesh": "Archer", "Emiya": "Archer", "Ishtar": "Archer",
    "Atalante": "Archer", "Robin Hood": "Archer", "Arash": "Archer",
    
    # Lancer Class
    "Cu Chulainn (Alter)": "Lancer", "Scathach": "Lancer", "Karna": "Lancer",
    "Diarmuid": "Lancer", "Cu Chulainn": "Lancer",
    
    # Rider Class
    "Ozymandias": "Rider", "Medusa": "Rider", "Boudica": "Rider",
    
    # Caster Class
    "Merlin": "Caster", "Tamamo-no-Mae": "Caster", "Medea": "Caster",
    "Medea (Lily)": "Caster", "Gilles de Rais": "Caster",
    
    # Assassin Class
    "Mysterious Heroine X": "Assassin", "Jack the Ripper": "Assassin",
    "Carmilla": "Assassin", "Hassan of the Cursed Arm": "Assassin",
    "Sasaki Kojiro": "Assassin",
    
    # Berserker Class
    "Cu Chulainn (Alter)": "Berserker", "Heracles": "Berserker",
    "Lancelot": "Berserker", "Spartacus": "Berserker", "Darius III": "Berserker",
    
    # Ruler Class
    "Jeanne d'Arc": "Ruler",
}

# Legacy city lookup for backward compatibility
city_lookup = class_lookup

filtered_words = ["nigger", "bitch", "cunt", "faggot"]

# Fate Singularities/Lostbelts for exploration dispatches
regions = {
    # key: canonical lower-case name -> display name and level
    # Levels represent singularity difficulty tiers
    "fuyuki": {"name": "Fuyuki", "level": 0},
    "orleans": {"name": "Orleans", "level": 5},
    "septem": {"name": "Septem", "level": 10},
    "okeanos": {"name": "Okeanos", "level": 25},
    "london": {"name": "London", "level": 35},
    "camelot": {"name": "Camelot", "level": 45},
    "babylonia": {"name": "Babylonia", "level": 50},
}

# Optional local path for the map image used by `gmap`.
# Place your map image at this path (relative to the bot project root) to have it shown in the embed.
MAP_IMAGE_PATH = "assets/fate_map.png"

# Gameplay tuning constants (change these to balance progression)
EXP_TUNING = {
    # EXP awarded per single wish
    "wish": 50,
    # EXP per region level when claiming a dispatch (dispatch_exp = region_level * value)
    "dispatch_per_region_level": 10,
    # EXP awarded when opening chests (kept here for central tuning)
    "chest_common": 10,
    "chest_exquisite": 25,
    "chest_precious": 50,
    "chest_luxurious": 100,
}

# Minimum account level required to use fishing
FISHING_MIN_LEVEL = 5

# Fish pool with 3 rarities: Common, Rare, Mythic
fish_pool = [
    # Common fish (10 total) - 70% chance
    {"name": "Medaka", "rarity": "Common", "icon": "游"},
    {"name": "Dawncatcher", "rarity": "Common", "icon": "游"},
    {"name": "Glaze Medaka", "rarity": "Common", "icon": "游"},
    {"name": "Sweet-Flower Medaka", "rarity": "Common", "icon": "游"},
    {"name": "Aizen Medaka", "rarity": "Common", "icon": "游"},
    {"name": "Puffer", "rarity": "Common", "icon": "游"},
    {"name": "Lazy Susan", "rarity": "Common", "icon": "游"},
    {"name": "Tea-Colored Shirakodai", "rarity": "Common", "icon": "游"},
    {"name": "Brown Shirakodai", "rarity": "Common", "icon": "游"},
    {"name": "Purple Shirakodai", "rarity": "Common", "icon": "游"},
    
    # Rare fish (12 total) - 25% chance
    {"name": "Betta", "rarity": "Rare", "icon": "游"},
    {"name": "Venomspine Fish", "rarity": "Rare", "icon": "游"},
    {"name": "Golden Koi", "rarity": "Rare", "icon": "游"},
    {"name": "Rusty Koi", "rarity": "Rare", "icon": "游"},
    {"name": "Crystalfish", "rarity": "Rare", "icon": "游"},
    {"name": "Lunged Stickleback", "rarity": "Rare", "icon": "游"},
    {"name": "Akai Maou", "rarity": "Rare", "icon": "游"},
    {"name": "Divda Ray", "rarity": "Rare", "icon": "游"},
    {"name": "Formalo Ray", "rarity": "Rare", "icon": "游"},
    {"name": "Maintenance Mek: Water", "rarity": "Rare", "icon": "游"},
    {"name": "Rippling Heartfeather Bass", "rarity": "Rare", "icon": "游"},
    {"name": "Streaming Axe Marlin", "rarity": "Rare", "icon": "游"},
    
    # Mythic fish (8 total) - 5% chance
    {"name": "Raimei Angelfish", "rarity": "Mythic", "icon": "游냐"},
    {"name": "Peach of the Deep Waves", "rarity": "Mythic", "icon": "游냐"},
    {"name": "Abiding Angelfish", "rarity": "Mythic", "icon": "游냐"},
    {"name": "Blazing Heartfeather Bass", "rarity": "Mythic", "icon": "游냐"},
    {"name": "Dawning Heartfeather Bass", "rarity": "Mythic", "icon": "游냐"},
    {"name": "Sternshield Crab", "rarity": "Mythic", "icon": "游"},
    {"name": "Lazurite Axe Marlin", "rarity": "Mythic", "icon": "游냐"},
    {"name": "True Fruit Angler", "rarity": "Mythic", "icon": "游냐"},
]

fish_rarity_weights = {"Common": 0.70, "Rare": 0.25, "Mythic": 0.05}

# Passive Abilities for Fate Servants
passive_abilities = {
    # Combat passives
    "charisma": {
        "name": "Charisma",
        "description": "+10% ATK to all allies",
        "type": "aura",
        "value": 0.10
    },
    "golden_rule": {
        "name": "Golden Rule",
        "description": "Extra rewards from victory",
        "type": "reward_bonus",
        "value": 1.5
    },
    "madness_enhancement": {
        "name": "Mad Enhancement",
        "description": "+25% ATK, -15% HP",
        "type": "stat_modifier",
        "atk_mult": 1.25,
        "hp_mult": 0.85
    },
    "wisdom_of_dun_scaith": {
        "name": "Wisdom of Dun Scaith",
        "description": "Quick cards gain +10% NP",
        "type": "np_bonus",
        "card_type": "quick",
        "value": 10
    },
    "manifestation_of_beauty": {
        "name": "Manifestation of Beauty",
        "description": "Arts cards deal +15% damage",
        "type": "damage_bonus",
        "card_type": "arts",
        "value": 0.15
    },
    "true_name_revelation": {
        "name": "True Name Revelation",
        "description": "Start battle with 30% NP",
        "type": "start_np",
        "value": 30
    },
    "imperial_privilege": {
        "name": "Imperial Privilege",
        "description": "50% chance to heal 15% HP when using Arts card",
        "type": "conditional_heal",
        "trigger": "arts",
        "chance": 0.50,
        "heal": 0.15
    },
    "dreamlike_charisma": {
        "name": "Dreamlike Charisma",
        "description": "+15% ATK and +20 starting NP to all allies",
        "type": "support",
        "atk_bonus": 0.15,
        "np_bonus": 20
    },
    "uncrowned_arms_mastership": {
        "name": "Uncrowned Arms Mastership",
        "description": "Buster cards have +20% crit chance",
        "type": "crit_bonus",
        "card_type": "buster",
        "value": 0.20
    },
    "cosmo_reactor": {
        "name": "Cosmo Reactor",
        "description": "+50% damage against Saber class",
        "type": "class_advantage",
        "target_class": "saber",
        "value": 0.50
    },
    "instinct": {
        "name": "Instinct",
        "description": "+15% crit chance on all cards",
        "type": "crit_bonus",
        "value": 0.15
    },
    "murderer_of_the_misty_night": {
        "name": "Murderer of the Misty Night",
        "description": "+30% damage at night (6PM-6AM)",
        "type": "time_bonus",
        "value": 0.30
    },
    "projection": {
        "name": "Projection",
        "description": "Arts cards charge NP +15%",
        "type": "np_bonus",
        "card_type": "arts",
        "value": 15
    },
    "battle_continuation": {
        "name": "Battle Continuation",
        "description": "Survive fatal blow once at 1 HP",
        "type": "survival",
        "uses": 1
    },
    "mystic_eyes": {
        "name": "Mystic Eyes",
        "description": "20% chance to stun enemy for 1 turn",
        "type": "stun",
        "chance": 0.20
    },
    "eternal_arms_mastership": {
        "name": "Eternal Arms Mastership",
        "description": "All cards deal consistent max damage",
        "type": "consistency"
    },
    "fox_wedding": {
        "name": "Fox's Wedding",
        "description": "Arts chains heal 10% HP",
        "type": "arts_heal",
        "value": 0.10
    },
    "calydonian_hunt": {
        "name": "Calydonian Hunt",
        "description": "Quick cards have +25% crit chance",
        "type": "crit_bonus",
        "card_type": "quick",
        "value": 0.25
    },
    "armor_of_fafnir": {
        "name": "Armor of Fafnir",
        "description": "Reduce all damage taken by 20%",
        "type": "damage_reduction",
        "value": 0.20
    },
    "high_speed_divine_words": {
        "name": "High-Speed Divine Words",
        "description": "NP charges 50% faster",
        "type": "np_gain",
        "value": 1.50
    },
    "love_spot": {
        "name": "Love Spot",
        "description": "25% chance to charm enemy, reducing their damage by 30%",
        "type": "charm",
        "chance": 0.25,
        "value": 0.30
    },
    "vampire": {
        "name": "Vampire",
        "description": "Drain 10% of damage dealt as HP",
        "type": "lifesteal",
        "value": 0.10
    },
    "protection_from_arrows": {
        "name": "Protection from Arrows",
        "description": "30% chance to dodge attacks",
        "type": "evasion",
        "chance": 0.30
    },
    "rapid_casting": {
        "name": "Rapid Casting",
        "description": "Arts cards charge NP +20%",
        "type": "np_bonus",
        "card_type": "arts",
        "value": 20
    },
    "sabotage": {
        "name": "Sabotage",
        "description": "Apply poison: 5% max HP damage per turn",
        "type": "poison",
        "value": 0.05
    },
    "presence_concealment": {
        "name": "Presence Concealment",
        "description": "First attack deals double damage",
        "type": "first_strike",
        "value": 2.0
    },
    "honor_of_the_battered": {
        "name": "Honor of the Battered",
        "description": "Gain +5% ATK for every 20% HP lost",
        "type": "low_hp_power",
        "threshold": 0.20,
        "bonus": 0.05
    },
    "robust_health": {
        "name": "Robust Health",
        "description": "Start with +30% max HP",
        "type": "hp_bonus",
        "value": 0.30
    },
    "mental_pollution": {
        "name": "Mental Pollution",
        "description": "Immune to charm and stun effects",
        "type": "immunity",
        "effects": ["charm", "stun"]
    },
    "eye_of_the_mind": {
        "name": "Eye of the Mind",
        "description": "35% chance to evade fatal blow",
        "type": "evasion_fatal",
        "chance": 0.35
    },
}